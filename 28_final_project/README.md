# Проект для промышленности

Чтобы оптимизировать производственные расходы, металлургический комбинат «Стальная птица» решил уменьшить потребление электроэнергии на этапе обработки стали. Для этого комбинату нужно контролировать температуру сплава. Наша задача — построить модель, которая будет её предсказывать. Заказчик хочет использовать разработанную модель для имитации технологического процесса. Изучим его, прежде чем генерировать новые признаки.

## Описание процесса обработки

Сталь обрабатывают в металлическом ковше вместимостью около 100 тонн. Чтобы ковш выдерживал высокие температуры, изнутри его облицовывают огнеупорным кирпичом. Расплавленную сталь заливают в ковш и подогревают до нужной температуры графитовыми электродами. Они установлены на крышке ковша.

Сначала происходит десульфурация — из стали выводят серу и корректируют её химический состав добавлением примесей. Затем сталь легируют — добавляют в неё куски сплава из бункера для сыпучих материалов или порошковую проволоку через специальный трайб-аппарат.

Прежде чем в первый раз ввести легирующие добавки, специалисты производят химический анализ стали и измеряют её температуру. Потом температуру на несколько минут повышают, уже после этого добавляют легирующие материалы и продувают сталь инертным газом, чтобы перемешать, а затем снова проводят измерения. Такой цикл повторяется до тех пор, пока не будут достигнуты нужный химический состав стали и оптимальная температура плавки.

Дальше расплавленная сталь отправляется на доводку металла или поступает в машину непрерывной разливки. Оттуда готовый продукт выходит в виде заготовок-слябов (англ. slab, «плита»).

## Общий вывод

**1. Этап предобработки данных**

На данном этапе данные были очищены от аномальных значений, которые были менее 1500 градусов, также был найден выброс с отрицательным значением мощности и заменен на среднее изменения реактивной мощности. Также были выявлены типы сыпучих и проволочных материалов, которые применялись не более 10 раз, но так как данных достаточно мало, было решено их оставить, возможно модели при обучении обнаружат необходимую взаимосвязь. Дополнительно данные были проверены на адекватность, а именно по времени подачи материалов, данный параметр не превышает суток. Были добавлены производные данные для увеличения признаков, на которых будут обучаться модели.

**2. Этап объединения таблиц и подготовки данных перед обучением на моделях**

После предобработки данных признаки были объединены по номеру партии. Проведен корреляционный анализ, который показал наибольшую взаимосвязь между данными, которые были использованы для генерации новых данных, т.е. утечка признака имела место. Также на примере партии с номеом 17, был посмотрен технологический процесс обработки стали, составленная последовательность соответствует описанию заказчика.

**3. Этап обучения моделей**
- Константная модель показала метрику МАЕ = 8.138 и самое быстрое время обучения менее 1 секунды.
- Модель линейной регрессии показало метрику МАЕ = 6.588 и время обучения 2 секунды.
- Модель случайного леса показало метрику МАЕ = 6.184 и время обучения равное 15 секундам.
- Модель градиентного бустинга LGB показал метрку МАЕ = 6.076 и время обучения 16 секунд.
- Модель градиентного бустинга CatBoost показала метрику МАЕ = 5.857 и самое долгое время обучения равное 20 минутам.
- Модель полносвязной нейронной сети библиотеки Keras показала метрику МАЕ = 11.123 и время обучения равное 10 минутам.

Для теста была выбрана модель градиентног бустинга CatBoost с наилучшим показателем метрики МАЕ и средним временем обучения.
На тесте модель показала метрику МАЕ = 5.771 - Задача тестирования и получения метрки МАЕ ниже 6.8 достигнута. Однако метрика R2 на уровне 0.5, что говорит о точности модели в 50%.

Анализ наиболее важных признаков для обучения модели CatBoost выявил два показателя: первоначальную температуру и время нагрева электродами.

**4. Рекомендации бизнесу**
- Следует увеличить количество входных данных, увеличив период сбора, чтобы потом повторно спустя некоторое время обновить и проверить качество модели.
- Также нужно постараться исправить датчики с температурой, так как 23% брака в данных крайне много.
- Данную модель можно использовать в предсказании температуры нагрева, так как ошибка в приблизительно в 6 градусов не окажет сильного влияния на процесс обработки.
